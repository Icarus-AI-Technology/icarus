# üìã .clinerules - Regras Obrigat√≥rias ICARUS v5.0

**ESTAS REGRAS S√ÉO OBRIGAT√ìRIAS E INVIOL√ÅVEIS**

Leia SEMPRE antes de desenvolver qualquer c√≥digo.

---

## üé® ORACLUSX DESIGN SYSTEM

### Regra 1: COMPONENTES SHADCN/UI OBRIGAT√ìRIOS

‚ùå **PROIBIDO** usar componentes HTML nativos:
```tsx
// ‚ùå NUNCA FA√áA ISSO
<input type="text" />
<button>Click</button>
<select><option>...</option></select>
<textarea></textarea>
```

‚úÖ **SEMPRE** use shadcn/ui:
```tsx
// ‚úÖ CORRETO
import { Input } from '@/components/ui/input'
import { Button } from '@/components/ui/button'
import { Select } from '@/components/ui/select'
import { Textarea } from '@/components/ui/textarea'

<Input />
<Button>Click</Button>
<Select>...</Select>
<Textarea />
```

---

### Regra 2: PALETA DE CORES UNIVERSAL

‚ùå **PROIBIDO** cores customizadas fora da paleta:
```tsx
// ‚ùå NUNCA
className="bg-blue-500"
className="text-red-600"
style={{ color: '#FF0000' }}
```

‚úÖ **SEMPRE** use a paleta universal:
```css
/* √öNICAS cores permitidas */
--primary: #6366F1      /* Indigo - COR PRINCIPAL */
--success: #10B981      /* Verde - Sucesso */
--warning: #F59E0B      /* Laranja - Avisos */
--danger: #EF4444       /* Vermelho - Perigo */
--background: #F9FAFB   /* Cinza claro - Fundo */
--foreground: #1F2937   /* Cinza escuro - Texto */
```

```tsx
// ‚úÖ CORRETO
className="bg-primary"
className="text-success"
className="border-warning"
className="bg-danger"
```

---

### Regra 3: INPUTS EM FORM-ROW

‚ùå **PROIBIDO** inputs sem label e form-row:
```tsx
// ‚ùå NUNCA
<Input placeholder="Nome" />
<Input type="email" />
```

‚úÖ **SEMPRE** use form-row com label:
```tsx
// ‚úÖ CORRETO
<div className="form-row">
  <label htmlFor="nome">Nome *</label>
  <Input id="nome" required />
</div>

<div className="form-row">
  <label htmlFor="email">Email</label>
  <Input id="email" type="email" />
</div>
```

---

### Regra 4: GRID RESPONSIVO 3/2/1

‚ùå **PROIBIDO** grids fixos:
```tsx
// ‚ùå NUNCA
<div className="grid grid-cols-3">
  {/* Quebra em mobile */}
</div>
```

‚úÖ **SEMPRE** use responsive grid 3/2/1:
```tsx
// ‚úÖ CORRETO
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  {/* 3 colunas desktop, 2 tablet, 1 mobile */}
</div>

// Para 4 colunas (KPIs)
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
  {/* 4 colunas desktop, 2 tablet, 1 mobile */}
</div>
```

---

### Regra 5: ACESSIBILIDADE OBRIGAT√ìRIA

‚ùå **PROIBIDO** bot√µes √≠cone sem aria-label:
```tsx
// ‚ùå NUNCA
<Button size="icon">
  <PlusIcon />
</Button>
```

‚úÖ **SEMPRE** adicione aria-label:
```tsx
// ‚úÖ CORRETO
<Button size="icon" aria-label="Adicionar novo item">
  <PlusIcon />
</Button>

<Button size="icon" aria-label="Deletar">
  <TrashIcon />
</Button>
```

---

### Regra 6: DIALOG EM VEZ DE ALERT/CONFIRM

‚ùå **PROIBIDO** usar alert/confirm do navegador:
```tsx
// ‚ùå NUNCA
alert('Erro!')
confirm('Tem certeza?')
```

‚úÖ **SEMPRE** use Dialog component:
```tsx
// ‚úÖ CORRETO
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'

<Dialog open={showError} onOpenChange={setShowError}>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Erro!</DialogTitle>
    </DialogHeader>
    <p>Descri√ß√£o do erro</p>
  </DialogContent>
</Dialog>
```

---

### Regra 7: VARIANTES DE BOT√ïES

‚ùå **PROIBIDO** customizar cores de bot√µes:
```tsx
// ‚ùå NUNCA
<Button className="bg-blue-600">Salvar</Button>
```

‚úÖ **SEMPRE** use variantes corretas:
```tsx
// ‚úÖ CORRETO
<Button variant="default">A√ß√£o Principal</Button>      // Indigo (#6366F1)
<Button variant="secondary">A√ß√£o Secund√°ria</Button>   // Cinza
<Button variant="destructive">Deletar</Button>         // Vermelho
<Button variant="outline">Cancelar</Button>            // Borda
<Button variant="ghost">Sutil</Button>                 // Transparente
```

---

### Regra 8: CARDS NEUM√ìRFICOS

‚ùå **PROIBIDO** cards sem classe neum√≥rfica:
```tsx
// ‚ùå NUNCA
<Card>
  <CardContent>...</CardContent>
</Card>
```

‚úÖ **SEMPRE** use classes neum√≥rficas:
```tsx
// ‚úÖ CORRETO
<Card className="neu-soft">      // Padr√£o (sombras suaves)
  <CardContent>...</CardContent>
</Card>

<Card className="neu-card">      // Maior profundidade
  <CardContent>...</CardContent>
</Card>
```

---

## üì¶ PADR√ÉO DE M√ìDULOS

### Regra 9: ESTRUTURA OBRIGAT√ìRIA

Todos os m√≥dulos **DEVEM** ter:

```tsx
export function NomeModulo() {
  return (
    <div className="p-6">
      {/* 1. KPIs (4-5 cards) - OBRIGAT√ìRIO */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <Card className="neu-card">
          <CardContent className="pt-6">
            <p className="text-sm text-gray-600">M√©trica</p>
            <p className="text-2xl font-bold">142</p>
            <p className="text-xs text-green-600">‚Üë 12.5%</p>
          </CardContent>
        </Card>
        {/* ... mais 3 KPIs */}
      </div>

      {/* 2. Tabs - OBRIGAT√ìRIO */}
      <Tabs defaultValue="overview">
        <TabsList>
          <TabsTrigger value="overview">Overview</TabsTrigger>
          <TabsTrigger value="lista">Lista</TabsTrigger>
          <TabsTrigger value="relatorios">Relat√≥rios</TabsTrigger>
          <TabsTrigger value="ia">IA</TabsTrigger>
        </TabsList>

        {/* 3. Conte√∫do das tabs */}
        <TabsContent value="overview">
          {/* Gr√°ficos + Dashboard */}
        </TabsContent>

        <TabsContent value="lista">
          {/* Tabela + CRUD */}
        </TabsContent>

        <TabsContent value="relatorios">
          {/* Relat√≥rios */}
        </TabsContent>

        <TabsContent value="ia">
          {/* Servi√ßos IA */}
        </TabsContent>
      </Tabs>
    </div>
  )
}
```

---

### Regra 10: NOMES DE ARQUIVOS

‚ùå **PROIBIDO**:
```
cirurgias.tsx
Cirurgias_Module.tsx
CirurgiasPage.tsx
```

‚úÖ **CORRETO**:
```
Cirurgias.tsx           // PascalCase, sem sufixo
Estoque.tsx
ContasReceber.tsx
```

---

## üóÑÔ∏è SUPABASE DATABASE

### Regra 11: SEMPRE TRATE ERROS

‚ùå **PROIBIDO** ignorar erros:
```tsx
// ‚ùå NUNCA
const { data } = await supabase.from('produtos').select('*')
// Sem verificar error!
```

‚úÖ **SEMPRE** verifique erros:
```tsx
// ‚úÖ CORRETO
const { data, error } = await supabase.from('produtos').select('*')

if (error) {
  console.error('Erro ao buscar produtos:', error)
  toast.error('Erro ao carregar produtos')
  return
}

// Agora pode usar data com seguran√ßa
```

---

### Regra 12: USE HOOKS/SERVICES

‚ùå **PROIBIDO** queries diretas em componentes:
```tsx
// ‚ùå NUNCA (em component)
useEffect(() => {
  supabase.from('produtos').select('*').then(...)
}, [])
```

‚úÖ **SEMPRE** use hooks customizados:
```tsx
// ‚úÖ CORRETO
// hooks/useProdutos.ts
export function useProdutos() {
  const [produtos, setProdutos] = useState([])
  const [loading, setLoading] = useState(false)

  useEffect(() => {
    async function fetchProdutos() {
      setLoading(true)
      const { data, error } = await supabase.from('produtos').select('*')

      if (error) {
        console.error(error)
        toast.error('Erro ao carregar produtos')
      } else {
        setProdutos(data)
      }

      setLoading(false)
    }

    fetchProdutos()
  }, [])

  return { produtos, loading }
}

// No component
const { produtos, loading } = useProdutos()
```

---

## üß† ICARUSBRAIN (IA)

### Regra 13: USE O HOOK CORRETO

‚ùå **PROIBIDO** chamadas diretas √† API:
```tsx
// ‚ùå NUNCA
fetch('https://api.anthropic.com/...', {
  headers: { 'x-api-key': '...' }
})
```

‚úÖ **SEMPRE** use useIcarusBrain:
```tsx
// ‚úÖ CORRETO
import { useIcarusBrain } from '@/hooks/useIcarusBrain'

const { predict, analyze, recommend, chat } = useIcarusBrain()

const forecast = await predict('demanda', { produto_id, dias: 30 })
```

---

### Regra 14: TRATE LOADING E ERROS DA IA

```tsx
// ‚úÖ CORRETO
const [loading, setLoading] = useState(false)
const [error, setError] = useState(null)

async function handlePredict() {
  setLoading(true)
  setError(null)

  try {
    const result = await predict('demanda', { produto_id, dias: 30 })
    // Usar resultado
  } catch (err) {
    setError(err.message)
    toast.error('Erro na previs√£o de demanda')
  } finally {
    setLoading(false)
  }
}
```

---

## üíª TYPESCRIPT

### Regra 15: STRICT MODE

‚ùå **PROIBIDO**:
```tsx
// ‚ùå NUNCA
const data: any = ...
// @ts-ignore
const result = ...
```

‚úÖ **SEMPRE** use tipos corretos:
```tsx
// ‚úÖ CORRETO
interface Produto {
  id: string
  nome: string
  preco: number
  ativo: boolean
}

const produtos: Produto[] = ...
```

---

### Regra 16: INTERFACES PARA PROPS

```tsx
// ‚úÖ CORRETO
interface ButtonProps {
  variant?: 'default' | 'secondary' | 'destructive'
  size?: 'sm' | 'md' | 'lg'
  children: React.ReactNode
  onClick?: () => void
}

export function Button({ variant = 'default', size = 'md', children, onClick }: ButtonProps) {
  // ...
}
```

---

## üß™ TESTES

### Regra 17: COBERTURA M√çNIMA

- **M√≠nimo**: 65% coverage
- **Meta**: 85% coverage
- **Obrigat√≥rio**: Testar l√≥gica complexa, hooks customizados, utils

```tsx
// ‚úÖ CORRETO
describe('useProdutos', () => {
  it('deve carregar produtos corretamente', async () => {
    const { result } = renderHook(() => useProdutos())

    await waitFor(() => {
      expect(result.current.produtos).toHaveLength(10)
      expect(result.current.loading).toBe(false)
    })
  })

  it('deve tratar erros', async () => {
    // Mock erro
    const { result } = renderHook(() => useProdutos())

    await waitFor(() => {
      expect(result.current.error).toBeDefined()
    })
  })
})
```

---

## üì± RESPONSIVIDADE

### Regra 18: TESTE EM 3 BREAKPOINTS

Sempre teste em:
- **Mobile**: 375px (iPhone SE)
- **Tablet**: 768px (iPad)
- **Desktop**: 1920px (Full HD)

```tsx
// ‚úÖ CORRETO - Responsive classes
<div className="
  p-4 md:p-6 lg:p-8              // Padding progressivo
  text-sm md:text-base lg:text-lg  // Font size responsivo
  grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3  // Grid responsivo
">
```

---

## üåì DARK MODE

### Regra 19: SEMPRE SUPORTE DARK MODE

‚ùå **PROIBIDO** cores fixas:
```tsx
// ‚ùå NUNCA
className="bg-white text-black"
```

‚úÖ **SEMPRE** use classes que funcionam em ambos:
```tsx
// ‚úÖ CORRETO
className="bg-background text-foreground"
className="bg-card text-card-foreground"
className="border-border"
```

---

## üìù COMMITS

### Regra 20: CONVEN√á√ÉO OBRIGAT√ìRIA

```bash
# Padr√£o: tipo(escopo): descri√ß√£o

# ‚úÖ CORRETO
feat(cirurgias): adicionar filtro por data
fix(estoque): corrigir c√°lculo de saldo
docs(readme): atualizar instala√ß√£o
refactor(ia): otimizar hook useIcarusBrain
test(cirurgias): adicionar testes unit√°rios
chore(deps): atualizar depend√™ncias

# ‚ùå ERRADO
adicionado filtro
fix bug
update
WIP
```

---

## ‚ö° PERFORMANCE

### Regra 21: BUNDLE SIZE

- **M√°ximo**: 1.5MB
- **Meta**: <800KB
- **Obrigat√≥rio**: Lazy loading de rotas e m√≥dulos pesados

```tsx
// ‚úÖ CORRETO
const Cirurgias = lazy(() => import('./components/modules/Cirurgias'))

<Suspense fallback={<Loading />}>
  <Cirurgias />
</Suspense>
```

---

### Regra 22: LIGHTHOUSE SCORE

- **M√≠nimo**: 90
- **Meta**: >95
- **Obrigat√≥rio**: Performance, Accessibility, Best Practices, SEO

---

## üîí SEGURAN√áA

### Regra 23: NUNCA COMMIT SECRETS

‚ùå **PROIBIDO** em c√≥digo:
```tsx
// ‚ùå NUNCA
const API_KEY = 'sk-ant-1234567890'
const SUPABASE_URL = 'https://...'
```

‚úÖ **SEMPRE** use .env:
```bash
# .env.local
VITE_ANTHROPIC_API_KEY=sk-ant-...
VITE_SUPABASE_URL=https://...
```

```tsx
// ‚úÖ CORRETO
const API_KEY = import.meta.env.VITE_ANTHROPIC_API_KEY
```

---

### Regra 24: VALIDE INPUTS

```tsx
// ‚úÖ CORRETO
import { z } from 'zod'

const produtoSchema = z.object({
  nome: z.string().min(3).max(100),
  preco: z.number().positive(),
  ativo: z.boolean()
})

try {
  const validated = produtoSchema.parse(formData)
  // Usar validated
} catch (err) {
  // Tratar erro de valida√ß√£o
}
```

---

## üìä MONITORAMENTO

### Regra 25: LOGGING ADEQUADO

‚ùå **PROIBIDO** console.log em produ√ß√£o:
```tsx
// ‚ùå NUNCA
console.log('dados:', data)
```

‚úÖ **SEMPRE** use logger estruturado:
```tsx
// ‚úÖ CORRETO
if (import.meta.env.DEV) {
  console.log('dados:', data)
}

// Para produ√ß√£o
logger.info('Produto criado', { produto_id: data.id })
logger.error('Erro ao criar produto', { error })
```

---

## üìö DOCUMENTA√á√ÉO

### Regra 26: JSDOC EM FUN√á√ïES COMPLEXAS

```tsx
// ‚úÖ CORRETO
/**
 * Calcula o score de inadimpl√™ncia do cliente
 * @param clienteId - ID do cliente
 * @param historicoMeses - Meses de hist√≥rico (padr√£o: 12)
 * @returns Score de 0-100 e classifica√ß√£o de risco
 */
export async function calcularScoreInadimplencia(
  clienteId: string,
  historicoMeses: number = 12
): Promise<{ score: number; risco: 'baixo' | 'medio' | 'alto' }> {
  // ...
}
```

---

## ‚úÖ CHECKLIST FINAL

Antes de commitar, verifique:

- [ ] Leu `.clinerules`?
- [ ] Seguiu OraclusX Design System?
- [ ] Usou componentes shadcn/ui (n√£o HTML nativo)?
- [ ] Paleta de cores universal?
- [ ] Inputs em form-row com label?
- [ ] Grid responsivo 3/2/1?
- [ ] Aria-labels em bot√µes √≠cone?
- [ ] Tratou erros Supabase?
- [ ] Usou hooks/services (n√£o queries diretas)?
- [ ] TypeScript strict (sem any/@ts-ignore)?
- [ ] Testou dark mode?
- [ ] Testou responsividade (mobile/tablet/desktop)?
- [ ] Lighthouse score >90?
- [ ] Bundle size ok?
- [ ] Testes passando?
- [ ] Sem console.log?
- [ ] Commit message segue conven√ß√£o?

---

**ESTAS REGRAS S√ÉO INVIOL√ÅVEIS**

Qualquer c√≥digo que violar estas regras ser√° **rejeitado** no code review.

**Vers√£o**: 1.0.0
**√öltima atualiza√ß√£o**: 2025-11-15

üöÄ **Agora desenvolva com excel√™ncia!**
