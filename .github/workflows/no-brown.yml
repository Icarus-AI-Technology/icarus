# ICARUS v5.1 - VerificaÃ§Ã£o de cores proibidas
# Dark Glass Medical Design System - ZERO tolerÃ¢ncia para marrom/bege/amarelo

name: ğŸ¨ Dark Glass Medical - Color Guard

on:
  push:
    branches: [main, develop, feature/*]
  pull_request:
    branches: [main, develop]

jobs:
  color-guard:
    name: ğŸš« Detectar Cores Proibidas
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: ğŸ” Verificar cores proibidas (amber/orange/yellow/stone/beige)
        run: |
          echo "ğŸ¨ ICARUS Dark Glass Medical - Color Guard"
          echo "============================================"
          echo ""
          echo "Verificando cores proibidas no cÃ³digo..."
          echo ""
          
          # Cores proibidas: amber, orange, yellow, stone, beige, tan
          # ExceÃ§Ã£o: comentÃ¡rios e strings de documentaÃ§Ã£o
          
          VIOLATIONS=$(grep -r -n -E "(bg-amber|bg-orange|bg-yellow|bg-stone|text-amber|text-orange|text-yellow|border-amber|border-orange|border-yellow|from-amber|from-orange|from-yellow|to-amber|to-orange|to-yellow)" \
            --include="*.tsx" \
            --include="*.ts" \
            --include="*.css" \
            src/ app/ components/ 2>/dev/null || true)
          
          if [ -n "$VIOLATIONS" ]; then
            echo "âŒ CORES PROIBIDAS ENCONTRADAS!"
            echo ""
            echo "$VIOLATIONS"
            echo ""
            echo "============================================"
            echo "ğŸš« BUILD REJEITADO"
            echo ""
            echo "O ICARUS usa APENAS o Dark Glass Medical palette:"
            echo "  â€¢ Fundo: slate-950, slate-900, slate-800"
            echo "  â€¢ PrimÃ¡ria: violet-600, purple-600"
            echo "  â€¢ Sucesso: emerald-600, teal-600"
            echo "  â€¢ Perigo: red-600, pink-600"
            echo "  â€¢ Info: cyan-600, blue-600"
            echo ""
            echo "Substitua as cores proibidas e tente novamente."
            exit 1
          fi
          
          echo "âœ… Sistema 100% limpo!"
          echo "ğŸ¨ Dark Glass Medical puro - nenhuma cor proibida encontrada."
          echo ""
          echo "Paleta aprovada:"
          echo "  â€¢ slate (fundos)"
          echo "  â€¢ violet/purple (primÃ¡ria)"
          echo "  â€¢ emerald/teal (sucesso)"
          echo "  â€¢ red/pink (perigo)"
          echo "  â€¢ cyan/blue (info)"

      - name: ğŸ“Š EstatÃ­sticas de cores
        if: always()
        run: |
          echo ""
          echo "ğŸ“Š EstatÃ­sticas de cores no projeto:"
          echo ""
          echo "Violet/Purple (primÃ¡ria):"
          grep -r -c "violet\|purple" src/ --include="*.tsx" 2>/dev/null | awk -F: '{sum+=$2} END {print "  " sum " ocorrÃªncias"}'
          
          echo "Emerald/Teal (sucesso):"
          grep -r -c "emerald\|teal" src/ --include="*.tsx" 2>/dev/null | awk -F: '{sum+=$2} END {print "  " sum " ocorrÃªncias"}'
          
          echo "Cyan/Blue (info):"
          grep -r -c "cyan\|blue" src/ --include="*.tsx" 2>/dev/null | awk -F: '{sum+=$2} END {print "  " sum " ocorrÃªncias"}'
          
          echo "Red/Pink (perigo):"
          grep -r -c "red\|pink" src/ --include="*.tsx" 2>/dev/null | awk -F: '{sum+=$2} END {print "  " sum " ocorrÃªncias"}'
          
          echo "Slate (fundos):"
          grep -r -c "slate" src/ --include="*.tsx" 2>/dev/null | awk -F: '{sum+=$2} END {print "  " sum " ocorrÃªncias"}'

